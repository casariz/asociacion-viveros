<section class="flex bg-light py-5 px-3">
    <h2>Cartera</h2>
    <div class="mx-auto max-w-md w-100 rounded bg-white p-2 shadow">
        <div class="d-flex justify-content-end">
            <form [formGroup]="filterForm" (ngSubmit)="applyFilters()">
                <div class="d-flex gap-2">
                    <input class="form-control" type="text" formControlName="description" placeholder="Descripción...">
                    <div class="d-flex gap-1">
                        <div class="btn-group">
                            <button class="btn btn-outline-secondary dropdown-toggle"
                                data-bs-toggle="dropdown">Estado</button>
                            <ul class="dropdown-menu">
                                @for (state of status; track $index) {
                                <li class="border-bottom p-2">
                                    <input type="checkbox" [checked]="statusFormArray.value.includes(state)"
                                        (change)="onStatusChange($event, state)">
                                    {{ state }}
                                </li>
                                }
                            </ul>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-outline-secondary" type="submit"><i class="fas fa-search"></i></button>
                        <button class="btn btn-outline-secondary" type="button" (click)="resetFilters()"><i
                                class="fas fa-delete-left text-danger"></i></button>
                    </div>
                </div>
            </form>
        </div>
        <table class="table table-hover caption-bottom text-sm">
            <thead>
                <tr>
                    <th class="text-start align-middle"></th>
                    <th class="text-start align-middle">ID</th>
                    <th class="text-start align-middle">DESCRIPCIÓN</th>
                    <th class="text-start align-middle">PERIODO [ALERTA]</th>
                    <th class="text-start align-middle">VENCE - ÚLTIMO REPORTE</th>
                    <th class="text-start align-middle">OBSERVACIONES</th>
                    <th class="text-start align-middle">ACCIONES</th>
                </tr>
            </thead>
            <tbody>
                @for (wallet of filteredWallets; track $index) {
                <tr>
                    <td class="align-middle">
                        <span class="badge">
                            <i class="fas fa-check-circle" style="color: #1b9123;"></i>
                        </span>
                    </td>
                    <td class="align-middle">{{ wallet.obligation_id }}</td>
                    <td class="align-middle">{{wallet.obligation_description}}</td>
                    <td class="align-middle">Cada {{ wallet.quantity }} {{wallet.period}} [{{ wallet.alert_time }} días previos]</td>
                    <td class="align-middle"> @if (!wallet.expiration_date) {N/A} @else {
                        }</td>
                    <td class="align-middle">
                        {{ wallet.observations }}
                    </td>
                    <td class="align-middle justify-content-center">
                        <div class="btn-group" role="group">
                            <a type="button" class="btn btn-outline-secondary" [routerLink]="['/', 'wallet', wallet.obligation_id, 'edit']">
                                <i class="fas fa-edit"></i>
                            </a>
                            <a type="button" class="btn btn-outline-secondary" [routerLink]="['/', 'wallet', 'report', wallet.obligation_id]">
                                <i class="fas fa-file-circle-check"></i>
                            </a>
                            <a type="button" class="btn btn-outline-secondary" [routerLink]="['/', 'wallet', wallet.obligation_id, 'view']">
                                <i class="fas fa-eye"></i>
                            </a>
                            <button type="button" class="btn btn-outline-secondary" (click)="deleteWallet(wallet.obligation_id)">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
                } @empty {
                <tr>
                    <td colspan="7" class="text-center">No se encontraron coincidencias en cartera.</td>
                </tr>
                }
            </tbody>
        </table>
        <nav aria-label="Page navigation example">
            <ul class="pagination justify-content-center">
                <li class="page-item disabled">
                    <a class="page-link">Previous</a>
                </li>
                <li class="page-item"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item">
                    <a class="page-link" href="#">Next</a>
                </li>
            </ul>
        </nav>
    </div>
    <div class="d-flex justify-content-end m-2 gap-2">
        <a routerLink="add-wallet" class="btn btn-lg rounded-circle btn-primary border-0 add-button"><i
                class="fas fa-plus"></i></a>
    </div>
</section>